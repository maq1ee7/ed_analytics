# Brama - LLM Processing Backend

**Brama** - ÑÑ‚Ğ¾ Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ñ‹Ğ¹ ÑĞµÑ€Ğ²Ğ¸Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ñ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒÑ LLM Ğ´Ğ»Ñ ED Analytics. ĞĞ½ Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°ĞµÑ‚ Ğ·Ğ° Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºÑƒ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ğ² Ñ„Ğ¾Ğ½Ğ¾Ğ²Ğ¾Ğ¼ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡ Bull/Redis.

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend   â”‚         â”‚      Redis       â”‚         â”‚     Brama       â”‚
â”‚  (Ğ¿Ğ¾Ñ€Ñ‚ 5000)â”‚â”€â”€â”€â”€â”€â”€â”€â”€>â”‚   (Ğ¿Ğ¾Ñ€Ñ‚ 6379)    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”‚  (Ğ¿Ğ¾Ñ€Ñ‚ 5001)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                                       â”‚
      â”‚                                                       â”‚
      â”‚  1. POST /api/process                                â”‚
      â”‚  { taskId, question, callbackUrl }                   â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
      â”‚                                                       â”‚
      â”‚                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                            â”‚  Bull Queue       â”‚
      â”‚                                            â”‚  (task added)     â”‚
      â”‚                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                                       â”‚
      â”‚                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                            â”‚  Worker Process   â”‚
      â”‚                                            â”‚  (processing...)  â”‚
      â”‚                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                                       â”‚
      â”‚  2. POST /api/callbacks/:taskId                      â”‚
      â”‚  { status: 'completed', result: {...} }              â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚                                                       â”‚
```

## ğŸ“¦ ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

### 1. **Express Server** (`src/server.ts`)
- HTTP ÑĞµÑ€Ğ²ĞµÑ€ Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 5001
- ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ¾Ñ‚ Backend
- Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Bull Board UI (dev Ñ€ĞµĞ¶Ğ¸Ğ¼)

### 2. **Queue Service** (`src/services/queueService.ts`)
- Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒÑ Ğ·Ğ°Ğ´Ğ°Ñ‡ Bull
- ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Redis
- ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸

### 3. **Task Processor** (`src/workers/taskProcessor.ts`)
- Worker Ğ´Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¸Ğ· Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸
- ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 2 Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸)
- Mock Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° 15 ÑĞµĞºÑƒĞ½Ğ´ (Ğ¸Ğ¼Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ñ LLM)
- ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ñ‡ĞµÑ€ĞµĞ· callback

### 4. **API Routes** (`src/routes/process.ts`)
- `POST /api/process` - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ
- Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° API ĞºĞ»ÑÑ‡Ğ¾Ğ¼

### 5. **Middleware** (`src/middleware/apiKeyAuth.ts`)
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° API ĞºĞ»ÑÑ‡Ğ° Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ·Ğ°Ñ‰Ğ¸Ñ‰ĞµĞ½Ğ½Ñ‹Ñ… endpoints

### 6. **LLM Services**
- `src/services/llmService.ts` - Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ DeepSeek API (Ñ‡ĞµÑ€ĞµĞ· AITunnel)
- `src/services/neo4jService.ts` - Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Neo4j Ğ±Ğ°Ğ·Ğ¾Ğ¹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- `src/services/queueService.ts` - Bull Queue (ÑƒĞ¶Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½ Ğ²Ñ‹ÑˆĞµ)

### 7. **Utilities**
- `src/utils/dashboardGenerator.ts` - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ¾Ğ² Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ LLM
- `src/utils/callbackSender.ts` - ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ² Backend
- `src/utils/llmLogger.ts` - Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ LLM Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
- `src/utils/prompts.ts` - ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚Ñ‹ Ğ´Ğ»Ñ DeepSeek
- `src/utils/regionMapper.ts` - ĞœĞ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ Ñ€ĞµĞ³Ğ¸Ğ¾Ğ½Ğ¾Ğ²
- `src/utils/tableListLoader.ts` - Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ÑĞ¿Ğ¸ÑĞºĞ° Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†
- `src/utils/tableSchemaGenerator.ts` - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ÑÑ…ĞµĞ¼ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†

## ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº

### Development Ñ€ĞµĞ¶Ğ¸Ğ¼

```bash
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹
cd brama
npm install

# Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ² dev Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ (Ñ hot reload)
npm run dev
```

### Production Ñ€ĞµĞ¶Ğ¸Ğ¼

```bash
# Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° TypeScript
npm run build

# Ğ—Ğ°Ğ¿ÑƒÑĞº production
npm start
```

### Docker

```bash
# Ğ˜Ğ· ĞºĞ¾Ñ€Ğ½ĞµĞ²Ğ¾Ğ¹ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
docker-compose up brama
```

## ğŸ”§ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Environment Variables

### ğŸ“‹ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ .env Ñ„Ğ°Ğ¹Ğ»Ğ°

Ğ’ÑĞµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ Ğ±ĞµÑ€ÑƒÑ‚ÑÑ Ğ¸Ğ· ĞºĞ¾Ñ€Ğ½ĞµĞ²Ğ¾Ğ³Ğ¾ `.env.example` Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°.

**Ğ¨Ğ°Ğ³ 1:** Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ `.env.example`
```bash
# Ğ’ ĞºĞ¾Ñ€Ğ½Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
cp .env.example .env
```

**Ğ¨Ğ°Ğ³ 2:** ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ½Ğ° **Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ**:

```bash
# DeepSeek API (Ñ‡ĞµÑ€ĞµĞ· AITunnel)
OPENAI_API_KEY=Ğ²Ğ°Ñˆ_Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹_ĞºĞ»ÑÑ‡_aitunnel
DEEPSEEK_MODEL=deepseek-chat

# Neo4j Database
NEO4J_PASSWORD=Ğ²Ğ°Ñˆ_Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹_Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ_neo4j

# API Keys (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°Ñ‚ÑŒ Ñ backend/.env)
ALLOWED_API_KEY=Ğ²Ğ°Ñˆ_api_ĞºĞ»ÑÑ‡
BACKEND_CORE_API_KEY=Ğ²Ğ°Ñˆ_api_ĞºĞ»ÑÑ‡
```

**Ğ¨Ğ°Ğ³ 3:** ĞÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¾ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ:

```bash
# Server
NODE_ENV=production
PORT=5001

# Redis
REDIS_HOST=redis
REDIS_PORT=6379

# Backend
BACKEND_URL=http://backend:5000

# Worker
WORKER_CONCURRENCY=2

# Data
DEFAULT_YEAR=2024
```

### ğŸ”‘ Ğ“Ğ´Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ API ĞºĞ»ÑÑ‡Ğ¸

#### 1. AITunnel API (DeepSeek)

**Ğ¨Ğ°Ğ³Ğ¸:**
1. ĞŸĞµÑ€ĞµĞ¹Ğ´Ğ¸Ñ‚Ğµ Ğ½Ğ° https://aitunnel.ru
2. Ğ—Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞ¹Ñ‚ĞµÑÑŒ Ğ¸Ğ»Ğ¸ Ğ²Ğ¾Ğ¹Ğ´Ğ¸Ñ‚Ğµ
3. ĞŸĞµÑ€ĞµĞ¹Ğ´Ğ¸Ñ‚Ğµ Ğ² Ñ€Ğ°Ğ·Ğ´ĞµĞ» **API Keys**
4. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ»ÑÑ‡
5. Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ ĞºĞ»ÑÑ‡ (Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ÑÑ Ñ `sk-aitunnel-...`)

**Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ:**
- DeepSeek v3.2: ĞĞ´Ğ¸Ğ½ Ğ¸Ğ· ÑĞ°Ğ¼Ñ‹Ñ… Ğ´ĞµÑˆĞµĞ²Ñ‹Ñ… LLM Ğ½Ğ° Ñ€Ñ‹Ğ½ĞºĞµ
- ĞĞ´Ğ¸Ğ½ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ â‰ˆ $0.001-0.002 (Ğ·Ğ½Ğ°Ñ‡Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ´ĞµÑˆĞµĞ²Ğ»Ğµ Claude)

#### 2. Neo4j Password

Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ğ½Ğ°Ğ´ĞµĞ¶Ğ½Ñ‹Ğ¹ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ:

```bash
openssl rand -base64 24
```

#### 3. Backend API Key

Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¹ ÑĞµĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡:

```bash
openssl rand -hex 32
```

**âš ï¸ Ğ’Ğ°Ğ¶Ğ½Ğ¾:** Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ **Ğ¾Ğ´Ğ¸Ğ½ Ğ¸ Ñ‚Ğ¾Ñ‚ Ğ¶Ğµ** ĞºĞ»ÑÑ‡ Ğ´Ğ»Ñ `ALLOWED_API_KEY` Ğ¸ `BACKEND_CORE_API_KEY`

### ğŸš€ ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹

ĞŸĞ¾ÑĞ»Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ `.env` Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ ÑĞµÑ€Ğ²Ğ¸Ñ:

```bash
# Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 1: Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº
docker-compose restart brama

# Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 2: ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ¿ĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ°
docker-compose down
docker-compose up -d --build brama
```

### âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸

**1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞº ÑĞµÑ€Ğ²Ğ¸ÑĞ°:**

```bash
docker logs ed_analytics_brama_dev
```

Ğ”Ğ¾Ğ»Ğ¶Ğ½Ñ‹ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ:
```
ğŸ¤– Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ LLM Ğ¸ Neo4j ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²...
[LLMService] Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ (Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ: deepseek-chat, Ğ³Ğ¾Ğ´: 2024)
[LLMService] DeepSeek API Ñ‡ĞµÑ€ĞµĞ· AITunnel Ğ¿Ñ€Ğ¾ĞºÑĞ¸
[Neo4jService] ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Neo4j: bolt://localhost:7687
âœ… Ğ¡ĞµÑ€Ğ²Ğ¸ÑÑ‹ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾
ğŸš€ Brama Backend is running
```

**2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ health endpoint:**

```bash
curl http://localhost:5001/health
```

**3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ:**

```bash
docker exec ed_analytics_brama_dev env | grep -E "OPENAI|DEEPSEEK|NEO4J"
```

**4. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ LLM Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²:**

```bash
# Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ»Ğ¾Ğ³Ğ¾Ğ²
docker exec ed_analytics_brama_dev ls -la /app/logs/llm/

# ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ»Ğ¾Ğ³
docker exec ed_analytics_brama_dev ls -lt /app/logs/llm/ | head -2
```

### ğŸ“Š Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ LLM Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

Ğ’ÑĞµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğº DeepSeek API Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ»Ğ¾Ğ³Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ² JSON Ñ„Ğ°Ğ¹Ğ»Ñ‹.

**Ğ Ğ°ÑĞ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ:** `brama/logs/llm/`

**Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ñ„Ğ°Ğ¹Ğ»Ğ°:** `query_[timestamp]_[id].json`

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ»Ğ¾Ğ³Ğ°:**
```json
{
  "queryId": "query_1234567890_abc123",
  "question": "Ğ¡ĞºĞ¾Ğ»ÑŒĞºĞ¾ ÑˆĞºĞ¾Ğ»ÑŒĞ½Ğ¸ĞºĞ¾Ğ² Ğ² Ğ²Ğ¾Ğ»Ğ³Ğ¾Ğ³Ñ€Ğ°Ğ´Ğµ",
  "timestamp": "2024-11-05T10:30:00.000Z",
  "steps": [
    {
      "step": 1,
      "stepName": "Ğ¨Ğ°Ğ³ 1: form_code + view_type",
      "prompt": "Ğ¢Ñ‹ â€” Ğ°ÑÑĞ¸ÑÑ‚ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹...",
      "response": "{\"form_code\": \"OO_1\"}",
      "inputTokens": 150,
      "outputTokens": 25,
      "durationMs": 1200,
      "cost": 0.00082
    }
  ],
  "totalTokens": 650,
  "totalCost": 0.00428,
  "totalDurationMs": 4500
}
```

**ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹:**

```bash
# ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ»Ğ¾Ğ³Ğ¾Ğ²
docker exec ed_analytics_brama_dev find /app/logs/llm/ -name "*.json" | wc -l

# Ğ¡ÑƒĞ¼Ğ¼Ğ°Ñ€Ğ½Ğ°Ñ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ
docker exec ed_analytics_brama_dev cat /app/logs/llm/*.json | grep totalCost | awk '{sum+=$2} END {print "Total: $" sum}'
```

### ğŸ”’ Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

âš ï¸ **Ğ’ĞĞ–ĞĞ:**
- âŒ ĞĞ• ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚ÑŒÑ‚Ğµ `.env` Ñ„Ğ°Ğ¹Ğ» Ğ² Git
- âŒ ĞĞ• Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚Ğµ API ĞºĞ»ÑÑ‡Ğ¸ Ğ² Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ¾Ğ¼ Ğ²Ğ¸Ğ´Ğµ
- âœ… Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ ĞºĞ»ÑÑ‡Ğ¸ Ğ´Ğ»Ñ dev/prod Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğ¹
- âœ… Ğ ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ğ¾ Ñ€Ğ¾Ñ‚Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ API ĞºĞ»ÑÑ‡Ğ¸

## ğŸ“Š Bull Board UI

Ğ’ **development** Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ğ²ĞµĞ±-Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸:

**URL:** `http://localhost:5001/admin/queues`

### Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸:
- âœ… ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡
- âœ… ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡
- âœ… ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ failed Ğ·Ğ°Ğ´Ğ°Ñ‡
- âœ… Retry failed Ğ·Ğ°Ğ´Ğ°Ñ‡
- âœ… ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸
- âœ… Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸

## ğŸ” API Endpoints

### POST `/api/process`

Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸.

**Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:** API ĞºĞ»ÑÑ‡ Ğ² Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞµ `X-API-Key`

**Request:**
```json
{
  "taskId": "uuid-task-id",
  "question": "Ğ’Ğ¾Ğ¿Ñ€Ğ¾Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ",
  "callbackUrl": "http://backend:5000/api/callbacks/:taskId"
}
```

**Response:**
```json
{
  "success": true,
  "taskId": "uuid-task-id",
  "message": "Task added to queue"
}
```

### GET `/health`

ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒÑ ÑĞµÑ€Ğ²Ğ¸ÑĞ°.

**Response:**
```json
{
  "status": "OK",
  "timestamp": "2025-11-04T12:00:00.000Z",
  "environment": "development",
  "queue": {
    "waiting": 0,
    "active": 1,
    "completed": 15,
    "failed": 0
  }
}
```

## ğŸ”„ Workflow Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸

1. **Backend Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ** â†’ `POST /api/process`
2. **Brama Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ** â†’ Bull Queue
3. **Worker Ğ±ĞµÑ€ĞµÑ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ** â†’ ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºÑƒ
4. **LLM Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°** â†’ DeepSeek API Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ (3 ÑˆĞ°Ğ³Ğ°)
5. **Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Neo4j** â†’ Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Cypher Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ´Ğ»Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
6. **Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ°** â†’ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ³Ğ¾ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ° Ğ¸ ĞºĞ°Ñ€Ñ‚Ñ‹ Ñ€ĞµĞ³Ğ¸Ğ¾Ğ½Ğ¾Ğ²
7. **ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°** â†’ `POST {callbackUrl}`
8. **Backend ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚** â†’ Ğ‘Ğ” Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ÑÑ
9. **Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ** â†’ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² `logs/llm/`

## ğŸ› ï¸ Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°

### Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
brama/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ server.ts                      # ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ ÑĞµÑ€Ğ²ĞµÑ€
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ process.ts                 # POST /api/process
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â””â”€â”€ apiKeyAuth.ts              # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° API ĞºĞ»ÑÑ‡Ğ°
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ queueService.ts            # Bull Queue setup
â”‚   â”‚   â”œâ”€â”€ llmService.ts              # DeepSeek API (Ñ‡ĞµÑ€ĞµĞ· AITunnel)
â”‚   â”‚   â””â”€â”€ neo4jService.ts            # Neo4j database
â”‚   â”œâ”€â”€ workers/
â”‚   â”‚   â””â”€â”€ taskProcessor.ts           # Worker Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ dashboardGenerator.ts      # LLM Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ¾Ğ²
â”‚   â”‚   â”œâ”€â”€ callbackSender.ts          # ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° callbacks
â”‚   â”‚   â”œâ”€â”€ llmLogger.ts               # Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ LLM
â”‚   â”‚   â”œâ”€â”€ prompts.ts                 # ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚Ñ‹ Ğ´Ğ»Ñ Claude
â”‚   â”‚   â”œâ”€â”€ regionMapper.ts            # ĞœĞ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ Ñ€ĞµĞ³Ğ¸Ğ¾Ğ½Ğ¾Ğ²
â”‚   â”‚   â”œâ”€â”€ tableListLoader.ts         # Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ÑĞ¿Ğ¸ÑĞºĞ¾Ğ² Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†
â”‚   â”‚   â””â”€â”€ tableSchemaGenerator.ts    # Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ÑÑ…ĞµĞ¼
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.ts                   # TypeScript Ñ‚Ğ¸Ğ¿Ñ‹
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ dashboardExample.json          # ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ°
â”‚   â”œâ”€â”€ regions.json                   # Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ€ĞµĞ³Ğ¸Ğ¾Ğ½Ğ¾Ğ²
â”‚   â”œâ”€â”€ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº_Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†_ĞĞ_1.csv        # Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† ĞĞ_1
â”‚   â””â”€â”€ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº_Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†_ĞĞ_2.csv        # Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† ĞĞ_2
â”œâ”€â”€ logs/llm/                          # LLM Ğ»Ğ¾Ğ³Ğ¸ (ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸)
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ Dockerfile
â””â”€â”€ README.md
```

### LLM Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ

Brama Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ñ **DeepSeek API** (Ñ‡ĞµÑ€ĞµĞ· AITunnel Ğ¿Ñ€Ğ¾ĞºÑĞ¸) Ğ´Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ².

**ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹:**

- `src/services/llmService.ts` - Ğ¡ĞµÑ€Ğ²Ğ¸Ñ Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ DeepSeek API Ñ‡ĞµÑ€ĞµĞ· AITunnel
- `src/services/neo4jService.ts` - Ğ¡ĞµÑ€Ğ²Ğ¸Ñ Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Neo4j Ğ±Ğ°Ğ·Ğ¾Ğ¹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- `src/utils/dashboardGenerator.ts` - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ¾Ğ² Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ LLM

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ğ°Ñ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ:** `deepseek-chat` (DeepSeek v3.2)

**Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:** Ğ’ÑĞµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğº DeepSeek Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ»Ğ¾Ğ³Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ² `logs/llm/` Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ¸ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸

## ğŸ“ˆ ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

### Ğ›Ğ¾Ğ³Ğ¸

Brama Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ñ‚ Ğ¿Ğ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ñ‹Ğµ Ğ»Ğ¾Ğ³Ğ¸ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸:

```
[Queue] Adding task abc-123 to queue
[Worker] Processing task abc-123
[Worker] Question: Ğ¡ĞºĞ¾Ğ»ÑŒĞºĞ¾ ÑˆĞºĞ¾Ğ»ÑŒĞ½Ğ¸ĞºĞ¾Ğ² Ğ² Ğ’Ğ¾Ğ»Ğ³Ğ¾Ğ³Ñ€Ğ°Ğ´Ğµ?
[LLMService] Ğ¨Ğ°Ğ³ 1: ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ form_code Ğ¸ view_type
[LLMService] ĞÑ‚Ğ²ĞµÑ‚ DeepSeek: {"form_code": "OO_1", "view_type": "Ğ³Ğ¾Ñƒ_Ğ³Ğ¾Ñ€Ğ¾Ğ´"}
[Neo4jService] Executing Cypher query...
[LLMLogger] Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ»Ğ¾Ğ³Ğ° Ğ² logs/llm/query_abc123.json
[Worker] Generating dashboard for task abc-123
[Worker] Sending success result for task abc-123
[Callback] Success: 200 OK
[Worker] Task abc-123 completed successfully
```

### Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸

Ğ§ĞµÑ€ĞµĞ· `/health` endpoint Ğ¸Ğ»Ğ¸ Bull Board UI:
- ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ² Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğ¸
- ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸
- Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸
- Failed Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸

## ğŸ”§ Troubleshooting

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ½Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ÑÑ‚ÑÑ

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Redis: `redis-cli ping`
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸ Brama: `docker-compose logs brama`
3. ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Bull Board: `http://localhost:5001/admin/queues`

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: Callback Ğ½Ğµ Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ´Ğ¾ Backend

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ `BACKEND_URL` Ğ² env
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ API ĞºĞ»ÑÑ‡ (`ALLOWED_API_KEY`)
3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ÑĞµÑ‚ĞµĞ²Ğ¾Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼ĞµĞ¶Ğ´Ñƒ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°Ğ¼Ğ¸

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: ĞÑ‡ĞµÑ€ĞµĞ´ÑŒ Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ°

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
1. Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡ÑŒÑ‚Ğµ `WORKER_CONCURRENCY` (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 2)
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ LLM Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ² Ğ»Ğ¾Ğ³Ğ°Ñ…
3. ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚Ğµ failed Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Bull Board
4. Ğ Ğ°ÑÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸Ñ‚Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‡Ğ°ÑÑ‚Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: ĞÑˆĞ¸Ğ±ĞºĞ¸ Ğ¿Ñ€Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğ¸ Ğº DeepSeek API

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚ÑŒ `OPENAI_API_KEY` (AITunnel ĞºĞ»ÑÑ‡)
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ° AITunnel Ğ½Ğ° https://aitunnel.ru
3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ API: https://api.aitunnel.ru/v1/
4. ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸Ñ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸ Ğ² `logs/llm/` Ğ´Ğ»Ñ Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: ĞÑˆĞ¸Ğ±ĞºĞ¸ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğº Neo4j

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ñ‡Ñ‚Ğ¾ Neo4j ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½: `docker ps | grep neo4j`
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ `NEO4J_URI` Ğ¸ `NEO4J_PASSWORD` Ğ² `.env`
3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸ Neo4j: `docker logs <neo4j_container>`
4. Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ Ñ‡Ñ‚Ğ¾ Ğ±Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ° Ğ¸Ğ· Ğ´Ğ°Ğ¼Ğ¿Ğ°



