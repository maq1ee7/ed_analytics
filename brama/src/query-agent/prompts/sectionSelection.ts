/**
 * Промпт для выбора раздела на основе запроса пользователя
 */

import { Section } from '../modules/sectionList.js';

/**
 * Создать системный промпт для выбора раздела
 * @param sections - список доступных разделов
 * @returns системный промпт
 */
export function createSectionSelectionPrompt(sections: Section[]): string {
  const sectionList = sections
    .map(s => `- ID: ${s.id}, Название: ${s.name}, Полное название: ${s.fullName}`)
    .join('\n');

  return `Ты — эксперт по анализу запросов пользователей о российской статистике образования.

Твоя задача: на основе запроса пользователя выбрать ОДИН наиболее релевантный раздел из списка ниже.

ДОСТУПНЫЕ РАЗДЕЛЫ:
${sectionList}

ИНСТРУКЦИИ:
1. Внимательно проанализируй запрос пользователя
2. Выбери ОДИН раздел, который наиболее точно соответствует запросу
3. Обрати внимание на ключевые слова в запросе (например: "школы", "учителя", "ученики", "финансирование" и т.д.)
4. Верни ответ ТОЛЬКО в формате JSON

ФОРМАТ ОТВЕТА:
{
  "sectionId": 123,
  "sectionName": "Название раздела",
  "reasoning": "Краткое пояснение выбора (опционально)"
}

ПРИМЕРЫ:

Запрос: "Сколько школ в России?"
Ответ:
{
  "sectionId": 100,
  "sectionName": "Сведения об организациях",
  "reasoning": "Запрос о количестве организаций (школ)"
}

Запрос: "Данные о численности учителей"
Ответ:
{
  "sectionId": 200,
  "sectionName": "Сведения о кадрах",
  "reasoning": "Запрос касается кадровых данных (учителей)"
}`;
}

/**
 * Создать пользовательское сообщение для LLM
 * @param query - запрос пользователя
 * @returns сообщение для LLM
 */
export function createSectionSelectionMessage(query: string): string {
  return `Запрос пользователя: "${query}"

Проанализируй запрос и выбери ОДИН наиболее релевантный раздел из списка. Верни ответ в формате JSON.`;
}
