# üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–µ–ø–ª–æ—è ED Analytics

## –ü—Ä–æ–±–ª–µ–º–∞

–°—Ç–∞—Ä—ã–π —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è –±—ã–ª –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–º –∏–∑-–∑–∞:
- ‚ùå –ü–æ–ª–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –∫–∞–∂–¥–æ–º –¥–µ–ø–ª–æ–µ
- ‚ùå –£–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö Docker –æ–±—Ä–∞–∑–æ–≤
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ–ª–∞–≥–∞ `--no-cache` (–ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞)
- ‚ùå –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ `scp` –∫–∞–∂–¥—ã–π —Ä–∞–∑

**–í—Ä–µ–º—è –¥–µ–ø–ª–æ—è: ~10-15 –º–∏–Ω—É—Ç** ‚è±Ô∏è

---

## –†–µ—à–µ–Ω–∏–µ

### üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–µ–ø–ª–æ—è

#### 1. `deploy.sh` - –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ô (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
./scripts/deploy.sh
```

**–£–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ –ù–µ —É–¥–∞–ª—è–µ—Ç –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ (—Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ñ–∞–π–ª—ã)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Docker –∫—ç—à –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏
- ‚úÖ –ù–µ —É–¥–∞–ª—è–µ—Ç Docker –æ–±—Ä–∞–∑—ã –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ `scp`

**–í—Ä–µ–º—è –¥–µ–ø–ª–æ—è: ~3-5 –º–∏–Ω—É—Ç** ‚è±Ô∏è

**–ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ (–∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à):**
```bash
FULL_REBUILD=true ./scripts/deploy.sh
```

---

#### 2. `deploy-fast.sh` - ULTRA-FAST (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å)
```bash
./scripts/deploy-fast.sh
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `rsync` –≤–º–µ—Å—Ç–æ `scp`
- ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- ‚úÖ –ò—Å–∫–ª—é—á–∞–µ—Ç `node_modules` –∏ `dist` –∏–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Docker –∫—ç—à

**–í—Ä–µ–º—è –¥–µ–ø–ª–æ—è: ~2-4 –º–∏–Ω—É—Ç—ã** ‚è±Ô∏è (–ø–µ—Ä–≤—ã–π —Ä–∞–∑ ~5 –º–∏–Ω—É—Ç)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
```bash
# –ï—Å–ª–∏ rsync –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
brew install rsync
```

**–ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞:**
```bash
FULL_REBUILD=true ./scripts/deploy-fast.sh
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –°–∫—Ä–∏–ø—Ç | –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π | –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–ø–ª–æ–∏ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à | –¢–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã |
|--------|--------------|-------------------|----------------|------------------------|
| **–°—Ç–∞—Ä—ã–π deploy.sh** | ~15 –º–∏–Ω | ~15 –º–∏–Ω | ‚ùå | ‚ùå |
| **–ù–æ–≤—ã–π deploy.sh** | ~5 –º–∏–Ω | ~3-4 –º–∏–Ω | ‚úÖ | ‚ùå |
| **deploy-fast.sh** | ~5 –º–∏–Ω | ~2-3 –º–∏–Ω | ‚úÖ | ‚úÖ |

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –û–±—ã—á–Ω—ã–π –¥–µ–ø–ª–æ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
./scripts/deploy-fast.sh
```

### –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞:
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `package.json` (–Ω–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
- –ü—Ä–æ–±–ª–µ–º—ã —Å –∫—ç—à–µ–º Docker
- –°—Ç—Ä–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
FULL_REBUILD=true ./scripts/deploy-fast.sh
```

### –î–ª—è –æ—Ç–ª–∞–¥–∫–∏:
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh -i ~/.ssh/llm-cpu/appuser-ed25519 appuser@130.193.46.4
cd ed_analytics
docker compose -f docker-compose.prod.yml logs -f

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose -f docker-compose.prod.yml ps

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker compose -f docker-compose.prod.yml restart backend
```

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

### 1. Docker –∫—ç—à
Docker —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–ª–æ–∏ (layers) –æ–±—Ä–∞–∑–æ–≤. –ü—Ä–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ:
- –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ª–æ–π
- –ï—Å–ª–∏ —Ñ–∞–π–ª –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Üí –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —ç—Ç–æ—Ç —Å–ª–æ–π –∏ —Å–ª–µ–¥—É—é—â–∏–µ

### 2. rsync vs scp
- `scp` - –∫–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑
- `rsync` - –∫–æ–ø–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç checksums)

### 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫
–°—Ç–∞—Ä—ã–π —Å–∫—Ä–∏–ø—Ç —É–¥–∞–ª—è–ª –≤—Å—é –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ ‚Üí —Ç–µ—Ä—è–ª–∏—Å—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ –∫—ç—à.
–ù–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã.

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (`package.json`) –ø–µ—Ä–≤–∞—è —Å–±–æ—Ä–∫–∞ –±—É–¥–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ–π
2. –ï—Å–ª–∏ —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã –ª–æ–∫–∞–ª—å–Ω–æ, –æ–Ω–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--delete` –≤ rsync)
3. –î–ª—è –æ—á–∏—Å—Ç–∫–∏ —Å—Ç–∞—Ä—ã—Ö –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—Ä–∞–∑–æ–≤ Docker:
   ```bash
   docker system prune -a --volumes
   ```

---

## üìù Changelog

### v2.0 - Ultra-Fast Deploy
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `deploy-fast.sh` —Å rsync
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –æ—Å–Ω–æ–≤–Ω–æ–π `deploy.sh`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `FULL_REBUILD`
- ‚úÖ –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### v1.0 - –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è
- ‚ùå –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
- ‚ùå –ú–µ–¥–ª–µ–Ω–Ω—ã–π –¥–µ–ø–ª–æ–π (~15 –º–∏–Ω)

